{
  "module": "communications",
  "titre": "Communications",
  "icone": "bi-envelope",
  "features": [
    {
      "id": "config_email",
      "titre": "Configurer le serveur email",
      "description": "Paramétrer le serveur SMTP pour l'envoi d'emails",
      "role_min": "administrateur",
      "procedure": [
        "Aller dans Paramètres > Communications > Configuration Email",
        "Cliquer 'Nouvelle configuration'",
        "Renseigner le nom et l'adresse expéditeur",
        "Configurer le serveur SMTP : host, port, utilisateur, mot de passe",
        "Tester la connexion",
        "Envoyer un email de test",
        "Définir comme configuration par défaut si souhaité"
      ],
      "faq": [
        {
          "question": "Quels serveurs SMTP sont supportés ?",
          "reponse": "Tous : Gmail, Office 365, OVH, Brevo, Amazon SES, serveurs personnels..."
        },
        {
          "question": "Les mots de passe sont-ils sécurisés ?",
          "reponse": "Oui, chiffrés en AES-256-CBC. Jamais affichés en clair après enregistrement."
        }
      ],
      "mots_cles": ["email", "smtp", "configuration", "serveur", "connexion"]
    },
    {
      "id": "config_sms",
      "titre": "Configurer les SMS",
      "description": "Paramétrer un fournisseur SMS",
      "role_min": "administrateur",
      "procedure": [
        "Aller dans Paramètres > Communications > Configuration SMS",
        "Cliquer 'Nouvelle configuration'",
        "Sélectionner le fournisseur : SMSFactor, Brevo, Twilio, OVH...",
        "Renseigner les identifiants API",
        "Définir le nom d'expéditeur (11 caractères max)",
        "Tester la connexion",
        "Vérifier les crédits disponibles"
      ],
      "faq": [
        {
          "question": "Les SMS sont-ils payants ?",
          "reponse": "Oui, les SMS consomment des crédits achetés auprès du fournisseur."
        },
        {
          "question": "Comment suivre la consommation ?",
          "reponse": "Le compteur de crédits est visible dans la configuration et les statistiques."
        }
      ],
      "mots_cles": ["sms", "configuration", "fournisseur", "credits", "api"]
    },
    {
      "id": "template_creation",
      "titre": "Créer un template de message",
      "description": "Définir un modèle de message réutilisable",
      "role_min": "administrateur",
      "procedure": [
        "Aller dans Paramètres > Communications > Templates",
        "Cliquer 'Nouveau template'",
        "Définir le code unique et le libellé",
        "Choisir le type : EMAIL, SMS, ou EMAIL_ET_SMS",
        "Rédiger le sujet (email) et le corps du message",
        "Utiliser les variables : {{prenom}}, {{nom}}, {{date_retour}}...",
        "Tester avec un aperçu",
        "Activer le template"
      ],
      "faq": [
        {
          "question": "Quelles variables sont disponibles ?",
          "reponse": "{{prenom}}, {{nom}}, {{email}}, {{telephone}}, {{code_barre}}, {{titre_article}}, {{date_retour}}, {{montant}}, etc."
        },
        {
          "question": "Le HTML est-il supporté dans les emails ?",
          "reponse": "Oui, vous pouvez utiliser du HTML pour la mise en forme."
        }
      ],
      "mots_cles": ["template", "modele", "message", "variable", "personnalisation"]
    },
    {
      "id": "declencheur_configuration",
      "titre": "Configurer les déclencheurs",
      "description": "Automatiser l'envoi de messages sur événements",
      "role_min": "administrateur",
      "procedure": [
        "Aller dans Paramètres > Communications > Événements",
        "Sélectionner l'événement à configurer",
        "Activer l'événement",
        "Associer un template email et/ou SMS",
        "Définir le délai si applicable (J-7, J-1, J+3...)",
        "Configurer les conditions si disponibles",
        "Tester l'envoi"
      ],
      "faq": [
        {
          "question": "Quels événements sont disponibles ?",
          "reponse": "Création usager, cotisation, emprunt, rappels avant/après échéance, réservation prête, etc."
        },
        {
          "question": "Les emails sont-ils envoyés immédiatement ?",
          "reponse": "Pour les événements immédiats oui. Les rappels sont traités par une tâche planifiée."
        }
      ],
      "mots_cles": ["declencheur", "evenement", "automatique", "notification"]
    },
    {
      "id": "envoi_manuel",
      "titre": "Envoyer un message manuellement",
      "description": "Contacter un usager directement",
      "role_min": "gestionnaire",
      "procedure": [
        "Ouvrir la fiche de l'usager",
        "Aller dans les actions ou l'onglet Communications",
        "Cliquer 'Envoyer email' ou 'Envoyer SMS'",
        "Choisir un template ou rédiger un message libre",
        "Vérifier l'aperçu avec les variables remplacées",
        "Cliquer 'Envoyer'"
      ],
      "faq": [
        {
          "question": "Peut-on envoyer à plusieurs usagers ?",
          "reponse": "Oui, via la sélection multiple dans la liste des usagers."
        }
      ],
      "mots_cles": ["envoi", "manuel", "email", "sms", "contact"]
    },
    {
      "id": "historique_consultation",
      "titre": "Consulter l'historique",
      "description": "Voir les messages envoyés et leur statut",
      "role_min": "gestionnaire",
      "procedure": [
        "Aller dans Communications > Historique",
        "Filtrer par type (Email/SMS), période, destinataire",
        "Voir le statut de chaque envoi (Envoyé, Échec)",
        "Cliquer sur un message pour voir les détails",
        "En cas d'échec, voir la raison de l'erreur"
      ],
      "faq": [
        {
          "question": "Peut-on renvoyer un message échoué ?",
          "reponse": "Oui, cliquez sur 'Renvoyer' dans le détail du message."
        },
        {
          "question": "L'historique est-il conservé combien de temps ?",
          "reponse": "Configurable. Par défaut, les données sensibles sont réduites après 30 jours."
        }
      ],
      "mots_cles": ["historique", "journal", "log", "statut", "erreur"]
    }
  ]
}
